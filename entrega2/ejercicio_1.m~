%%%%%%
%
% Neurona No Lineal para el archivo Drug5.csv
%
%
%%%%%%

datos = csvread('drug5.csv');

[CantFilas, CantCols] = size(datos);

% Escalo
M = escalar(datos, 1:CantCols-1);

% Convierto la clase en 1 (cuando es 1) y 0 (cuando es distinto de 1)
unos = find(M(:,CantCols) == 1);
M(:, CantCols) = 0;
M(unos, CantCols) = 1;

% Separo en Train y Test
[M_Train, M_Test] = separar_train_test(M, 80);

P_Train = M_Train(:, 1:CantCols - 1);
T_Train = M_Train(:, CantCols);

P_Test = M_Test(:, 1:CantCols - 1);
T_Test = M_Test(:, CantCols);

[W,b] = neurona_no_lineal(P_Train', T_Train', 0.02, 0.000001, 1000, 'logsig');

correctos_train = evaluar_logsig(P_Train', T_Train', W, b); 
correctos_train = evaluar_logsig(P_Train', T_Train', W, b); 




